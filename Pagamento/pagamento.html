<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pagamento | Perif√©ricoStore</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

  <style>
  </style>
</head>

<body>

   <!-- Cabe√ßalho -->
  <header>
    <a href="../tela_principal/site.html"><img src="../image/logo_perifericos_store_PS_sem_frase_branco.png" alt="Perif√©ricoStore"></a>    
    </div>
  </header>

  <div class="checkout-container">
    <h2>Resumo do Pedido</h2>

    <div class="cart-items" id="cart-items"></div>

    <div class="summary">
      <p><strong>Subtotal:</strong> <span id="subtotal">R$ 0,00</span></p>
      <p><strong>Frete:</strong> <span id="frete">R$ 0,00</span></p>
      <hr>
      <p><strong>Total:</strong> <span id="total">R$ 0,00</span></p>
    </div>

    <div class="frete-section">
      <h3>Calcular Frete</h3>
      <input type="text" id="cep" placeholder="Digite seu CEP">
      <button id="calcular-frete">Calcular</button>
      <div class="frete-options" id="frete-options"></div>
      <p class="info" id="frete-info"></p>
    </div>

    <h3>M√©todo de Pagamento</h3>
    <div class="payment-methods">
      <div class="method active" data-method="cartao">üí≥ Cart√£o</div>
      <div class="method" data-method="pix">‚ö° Pix</div>
    </div>

    <div id="payment-form"></div>

    <button class="btn" id="confirmar">Confirmar Pagamento</button>
  </div>

  <!-- Tela de carregamento -->
  <div class="loading-screen" id="loading-screen">
    <div class="spinner"></div>
    <p>Processando pagamento...</p>
  </div>

  <script>
    // ===== MOCK DO CARRINHO =====
    if (!localStorage.getItem('carrinho')) {
      const mockCarrinho = [
        { nome: 'üéß Headset Gamer RGB', preco: 250.00 },
        { nome: 'üñ±Ô∏è Mouse Redragon', preco: 120.00 }
      ];
      localStorage.setItem('carrinho', JSON.stringify(mockCarrinho));
    }

    const carrinho = JSON.parse(localStorage.getItem('carrinho')) || [];
    const cartContainer = document.getElementById('cart-items');
    const subtotalEl = document.getElementById('subtotal');
    const freteEl = document.getElementById('frete');
    const totalEl = document.getElementById('total');
    const freteInfo = document.getElementById('frete-info');
    const freteOptions = document.getElementById('frete-options');

    let subtotal = 0;
    let valorFrete = 0;

    cartContainer.innerHTML = '';
    carrinho.forEach(item => {
      subtotal += item.preco;
      const div = document.createElement('div');
      div.classList.add('cart-item');
      div.innerHTML = `<span>${item.nome}</span><span>R$ ${item.preco.toFixed(2)}</span>`;
      cartContainer.appendChild(div);
    });

    subtotalEl.textContent = `R$ ${subtotal.toFixed(2)}`;
    totalEl.textContent = `R$ ${subtotal.toFixed(2)}`;

    // ===== CALCULAR FRETE =====
    document.getElementById('calcular-frete').addEventListener('click', () => {
      const cep = document.getElementById('cep').value.trim();

      if (!cep || cep.length < 8) {
        freteInfo.textContent = 'Por favor, insira um CEP v√°lido.';
        return;
      }

      if (subtotal >= 300) {
        valorFrete = 0;
        freteEl.textContent = 'Gr√°tis';
        totalEl.textContent = `R$ ${subtotal.toFixed(2)}`;
        freteInfo.textContent = 'Frete gr√°tis para pedidos acima de R$ 300!';
        freteOptions.innerHTML = '';
        return;
      }

      // Mock das op√ß√µes
      const pac = 22.90;
      const sedex = 34.50;

      freteOptions.innerHTML = `
        <label><input type="radio" name="frete" value="${pac}" checked> PAC - R$ ${pac.toFixed(2)}</label>
        <label><input type="radio" name="frete" value="${sedex}"> SEDEX - R$ ${sedex.toFixed(2)}</label>
      `;

      document.querySelectorAll('input[name="frete"]').forEach(radio => {
        radio.addEventListener('change', e => {
          valorFrete = parseFloat(e.target.value);
          atualizarTotal();
        });
      });

      valorFrete = pac;
      atualizarTotal();
      freteInfo.textContent = 'Selecione a modalidade de entrega.';
    });

    function atualizarTotal() {
      freteEl.textContent = `R$ ${valorFrete.toFixed(2)}`;
      totalEl.textContent = `R$ ${(subtotal + valorFrete).toFixed(2)}`;
    }

    // ===== M√âTODOS DE PAGAMENTO =====
    const paymentForm = document.getElementById('payment-form');
    document.querySelectorAll('.method').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.method').forEach(m => m.classList.remove('active'));
        btn.classList.add('active');

        const metodo = btn.dataset.method;
        if (metodo === 'cartao') {
          paymentForm.innerHTML = `
            <h4>Pagamento com Cart√£o</h4>
            <input type="text" placeholder="N√∫mero do cart√£o" style="width:80%;padding:8px;margin:5px;border-radius:5px;border:1px solid #ccc;"><br>
            <input type="text" placeholder="Validade (MM/AA)" style="width:38%;padding:8px;margin:5px;border-radius:5px;border:1px solid #ccc;">
            <input type="text" placeholder="CVV" style="width:38%;padding:8px;margin:5px;border-radius:5px;border:1px solid #ccc;"><br>
            <input type="text" placeholder="Nome no cart√£o" style="width:80%;padding:8px;margin:5px;border-radius:5px;border:1px solid #ccc;">
          `;
        } else {
          paymentForm.innerHTML = `
            <h4>Pagamento via Pix</h4>
            <p>Escaneie o QR Code abaixo para efetuar o pagamento:</p>
            <img src="https://api.qrserver.com/v1/create-qr-code/?data=PIX:123e4567-e89b-12d3-a456-426614174000&size=200x200" alt="QR Code Pix">
          `;
        }
      });
    });

    // ===== CONFIRMAR PAGAMENTO =====
    document.getElementById('confirmar').addEventListener('click', () => {
      const loading = document.getElementById('loading-screen');
      loading.style.display = 'flex';

      setTimeout(() => {
        loading.style.display = 'none';
        alert('aguardando aprova√ß√£o de pagamento...');
        localStorage.removeItem('carrinho');
        window.location.href ="confirmacao.html";
      }, 3000);
    });
  </script>
</body>
</html>
